!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!            IMPLEMENTATION OF LEAKY INTEGRATE-AND-FIRE NEURON               !!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
	SUBROUTINE lif()
	USE PARAMETERS
	USE VARIABLES
	IMPLICIT NONE
!============= calculation of membrane potential if not in refrac period ==================!
	IF((tr-spkt_post).GT.pr(3)) THEN
	!---------------------------- total conductance -------------------------------------------!
		x(21) = 1.0d0 + x(2) + x(3)
	!------------------------------------------------------------------------------------------!
	!------------------------------- u infinity -----------------------------------------------!
		x(22) = ( pr(2) + x(3)*pr(32) )/x(21)
	!------------------------------------------------------------------------------------------!
	!---------------------------- e^(-dt/tau effective) ---------------------------------------!
		x(23) = pr(1)/x(21)
		x(23) = DEXP(-1.0d0*dt/x(23))
	!------------------------------------------------------------------------------------------!
	!------------------------------- membrane potential ---------------------------------------!
		x(1) = x(1)*x(23) + x(22)*(1.0d0-x(23))
	!------------------------------------------------------------------------------------------!
	END IF
!==========================================================================================!
!=========================== update of synaptic conductances ==============================!
	x(2) = x(2)*pr(35)		!decay of AMPA conductance
	x(3) = x(3)*pr(36)		!decay of GABA_A conductance
!==========================================================================================!
!======================== resetting spike variable to NO spike ============================!
	spk_post = .FALSE.
!==========================================================================================!
!====================================== spike =============================================!
	IF(x(1).GE.pr(4)) THEN
		spkt_post = tr		!spike timing
		spk_post = .TRUE.	!spike variable to YES
		x(1) = pr(2)		!reset membrane potential
	END IF
!==========================================================================================!
	END SUBROUTINE
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
